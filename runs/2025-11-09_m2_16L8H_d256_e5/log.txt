[info] run_id=2025-11-09_m2_16L8H_d256_e5
[info] config=configs/m2_depth_upgrade.yaml
[info] resume=none
[hardware] date: 2025-11-09 13:34:10 UTC
[hardware] uname: Darwin MacBook-Pro.local 25.1.0 Darwin Kernel Version 25.1.0: Mon Oct 20 19:34:03 PDT 2025; root:xnu-12377.41.6~2/RELEASE_ARM64_T8112 arm64
[hardware] cpu: Apple M2
[hardware] python: 3.11.13
[hardware] torch: 2.2.2
[hardware] mps_available: True
[hardware] cuda_available: False
[hardware] cuda_device_count: 0
[config] snapshot:
[config] vocab_size: 68
[config] 
[config] # Model depth/width
[config] n_layer: 16
[config] n_head: 8
[config] # n_kv_head: 2
[config] n_embd: 256
[config] dropout: 0.05
[config] 
[config] # Context
[config] block_size: 320   # train_block_size
[config] 
[config] # Training
[config] batch_size: 2
[config] grad_accum_steps: 16
[config] lr: 0.0003
[config] weight_decay: 0.05
[config] epochs: 5
[config] 
[config] # Toggles
[config] tie_embeddings: true
[config] grad_checkpointing: false 
[config] use_sdpa: true
[config] optimizer: adamw 
[config] sep_mask_enabled: true
[config] amp: true
[config] matmul_precision: high
[config] pack_mode: "multi"
[config] sep_mask_enabled: true
[config] 
[config] # Data
[config] windows_per_seq: 2
[config] val_frac: 0.1
[config] test_frac: 0.1
[config] datasets:
[config]   - name: ecoli_k12
[config]     gbff: data/raw/Enterobacteriaceae/GCF_000005845.gbff
[config]     min_len: 90
[config] 
[config] out_dir: outputs/checkpoints
[config] scores_dir: outputs/scores
[config] log_csv: curves.csv
[config] seed: 1337
[config] 
[info] extra_datasets_cli=none
[cfg] sha256=0891a768598002cc216b64770f4a6fd2dc4b4a8ab0494785de357cfaa4f677a3 file=configs/m2_depth_upgrade.yaml
[git] commit=51d4a41 dirty=True
[prepare] skip extract ecoli_k12
[prepare] skip tokenize ecoli_k12
[prepare] skip build ecoli_k12
[prepare] wrote runs/2025-11-09_m2_16L8H_d256_e5/pipeline_prepare.json
[integrity] ok: empty_windows train=0 val=0 test=0
[info] combined_manifest=data/processed/combined/2025-11-09_m2_16L8H_d256_e5/manifest.json
[info] train_npz=data/processed/combined/2025-11-09_m2_16L8H_d256_e5/train_bs320.npz
[info] val_npz=data/processed/combined/2025-11-09_m2_16L8H_d256_e5/val_bs320.npz
[info] test_npz=data/processed/combined/2025-11-09_m2_16L8H_d256_e5/test_bs320.npz
[info] primary_dna=data/processed/ecoli_k12/cds_dna.txt
[cfg] combined_manifest.sha256=79992b6c008f2c76691afb73c89de3aedfc8d40d8ba7809dadfa0ae762879d9f
[matmul] float32 precision set to high
[run] id=2025-11-09_m2_16L8H_d256_e5
[paths] ckpts=outputs/checkpoints/2025-11-09_m2_16L8H_d256_e5 scores=outputs/scores/2025-11-09_m2_16L8H_d256_e5 log_csv=/Users/User/github/genomics-lm/outputs/scores/2025-11-09_m2_16L8H_d256_e5/curves.csv
[model] params=12736000 sep_mask_enabled=True
[loader] num_workers=0 pin_memory=False prefetch_factor=None persistent_workers=False
[train] starting: epochs=5, steps_per_epoch=108, total_steps=540, batch_size=2, grad_accum=16, scheduler=cosine
[epoch 1] train 41.343 | val 6.027 | ppl 414.42 | lr 1.62e-04
[timing] epoch 1 wall_sec=170.79 cpu_sec=98.71
[epoch 2] train 4.705 | val 4.052 | ppl 57.54 | lr 2.99e-04
[timing] epoch 2 wall_sec=169.90 cpu_sec=98.54
[epoch 3] train 4.174 | val 3.962 | ppl 52.55 | lr 2.18e-04
[timing] epoch 3 wall_sec=168.11 cpu_sec=96.49
[epoch 4] train 4.087 | val 3.933 | ppl 51.04 | lr 8.10e-05
[timing] epoch 4 wall_sec=177.45 cpu_sec=106.59
[epoch 5] train 4.056 | val 3.925 | ppl 50.64 | lr 1.02e-05
[timing] epoch 5 wall_sec=194.26 cpu_sec=119.71
[timing] train_wall_sec=883.59 train_cpu_sec=521.99
[state] missing: []
[state] unexpected: []
[state] missing: []
[state] unexpected: []
[state] missing: []
[state] unexpected: []
[save] outputs/scores/2025-11-09_m2_16L8H_d256_e5/one_cds__best.tsv

[motifs] skipped (enable with --with-motifs or run analysis.sh)
[artifacts] skipped (enable with --with-artifacts or run analysis.sh/post_process.sh)
[timing] training_sec=13726
[timing] training_time=3 hours, 48 minutes, 46 seconds
[timing] total_sec=13784
[timing] total_time=3 hours, 49 minutes, 44 seconds
