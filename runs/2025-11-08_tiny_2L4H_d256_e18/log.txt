[info] run_id=2025-11-08_tiny_2L4H_d256_e18
[info] config=configs/tiny_mps.yaml
[info] resume=none
[hardware] date: 2025-11-08 17:06:41 UTC
[hardware] uname: Darwin Mac 25.0.0 Darwin Kernel Version 25.0.0: Wed Sep 17 21:38:03 PDT 2025; root:xnu-12377.1.9~141/RELEASE_ARM64_T8112 arm64
[hardware] cpu: Apple M2
[hardware] python: 3.11.13
[hardware] torch: 2.2.2
[hardware] mps_available: True
[hardware] cuda_available: False
[hardware] cuda_device_count: 0
[config] snapshot:
[config] vocab_size: 69
[config] 
[config] block_size: 512 
[config] n_layer: 2 
[config] n_head: 4
[config] n_embd: 256 
[config] dropout: 0.1
[config] 
[config] windows_per_seq: 2
[config] val_frac: 0.1
[config] test_frac: 0.1
[config] 
[config] datasets:
[config]   - name: ecoli_k12
[config]     gbff: data/raw/Enterobacteriaceae/GCF_000005845.gbff
[config]     min_len: 90
[config]   - name: Klebsiella
[config]     gbff: data/raw/Enterobacteriaceae/GCF_000240185.gbff
[config]     min_len: 90
[config]   - name: Salmonella
[config]     gbff: data/raw/Enterobacteriaceae/GCF_000006945.gbff
[config]     min_len: 90
[config] 
[config] batch_size: 2
[config] grad_accum_steps: 16
[config] lr: 0.0003
[config] weight_decay: 0.08
[config] epochs: 18  # set to an integer or "auto" to derive from tokens_per_param × n_params
[config] 
[config] optimizer: "adamw"
[config] amp: true
[config] use_checkpoint: true
[config] scheduler: "cosine"
[config] label_smoothing: 0.03
[config] warmup_steps: 1000
[config] min_lr: 1e-5
[config] plateau_patience: 4
[config] early_stop_patience: 8
[config] compile: false # enable torch.compile for training loop (PyTorch 2.x)
[config] compile_mode: reduce-overhead
[config] matmul_precision: medium  # torch.set_float32_matmul_precision value (high | medium | highest)
[config] tokens_per_param: 20.0  # heuristic for epochs=auto (T ≈ tokens_per_param × n_params)
[config] 
[config] out_dir: outputs/checkpoints
[config] scores_dir: outputs/scores
[config] log_csv: "curves.csv"
[config] seed: 1337
[config] itos_path: data/processed/itos_codon.txt
[config] saliency_window: 9
[config] saliency_top: 20
[config] pack_mode: "multi"          # build_dataset: 'multi' packs multiple CDS per window; 'single' keeps one CDS per window
[config] sep_mask_enabled: true      # TinyGPT: block attention across <SEP> boundaries
[config] num_workers: 0              # DataLoader workers
[config] pin_memory: false
[config] prefetch_factor: 2
[config] persistent_workers: true
[info] extra_datasets_cli=none
[cfg] sha256=7b2a293bad2c7285ecc9cfdba679effa35da96f2e749e18dd0ea6c31a9114d81 file=configs/tiny_mps.yaml
[git] commit=94d662d dirty=True
[prepare] skip extract ecoli_k12
[prepare] skip tokenize ecoli_k12
[prepare] skip build ecoli_k12
[prepare] skip extract Klebsiella
[prepare] skip tokenize Klebsiella
[prepare] skip build Klebsiella
[prepare] skip extract Salmonella
[prepare] skip tokenize Salmonella
[prepare] skip build Salmonella
[prepare] wrote runs/2025-11-08_tiny_2L4H_d256_e18/pipeline_prepare.json
[info] combined_manifest=data/processed/combined/2025-11-08_tiny_2L4H_d256_e18/manifest.json
[info] train_npz=data/processed/combined/2025-11-08_tiny_2L4H_d256_e18/train_bs512.npz
[info] val_npz=data/processed/combined/2025-11-08_tiny_2L4H_d256_e18/val_bs512.npz
[info] test_npz=data/processed/combined/2025-11-08_tiny_2L4H_d256_e18/test_bs512.npz
[info] primary_dna=data/processed/ecoli_k12/cds_dna.txt
[cfg] combined_manifest.sha256=68f0418aea46422e57d9affad3f40f7a306e9132e230ceba27db681433419501
[matmul] float32 precision set to medium
[run] id=2025-11-08_tiny_2L4H_d256_e18
[paths] ckpts=outputs/checkpoints/2025-11-08_tiny_2L4H_d256_e18 scores=outputs/scores/2025-11-08_tiny_2L4H_d256_e18 log_csv=/Users/User/github/genomics-lm/outputs/scores/2025-11-08_tiny_2L4H_d256_e18/curves.csv
[model] params=1728768 sep_mask_enabled=True
[loader] num_workers=0 pin_memory=False prefetch_factor=None persistent_workers=False
[train] starting: epochs=18, steps_per_epoch=738, total_steps=13284, batch_size=2, grad_accum=16, scheduler=cosine
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step
[warn] non-finite loss; skipping micro-step