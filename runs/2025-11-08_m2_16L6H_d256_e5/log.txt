[info] run_id=2025-11-08_m2_16L6H_d256_e5
[info] config=configs/m2_depth_upgrade.yaml
[info] resume=none
[hardware] date: 2025-11-08 21:20:48 UTC
[hardware] uname: Darwin Mac 25.1.0 Darwin Kernel Version 25.1.0: Mon Oct 20 19:34:03 PDT 2025; root:xnu-12377.41.6~2/RELEASE_ARM64_T8112 arm64
[hardware] cpu: Apple M2
[hardware] python: 3.11.13
[hardware] torch: 2.2.2
[hardware] mps_available: True
[hardware] cuda_available: False
[hardware] cuda_device_count: 0
[config] snapshot:
[config] vocab_size: 68
[config] 
[config] # Model depth/width
[config] n_layer: 16
[config] n_head: 6
[config] n_kv_head: 2
[config] n_embd: 256
[config] dropout: 0.05
[config] 
[config] # Context
[config] block_size: 320   # train_block_size
[config] 
[config] # Training
[config] batch_size: 2
[config] grad_accum_steps: 16
[config] lr: 0.0003
[config] weight_decay: 0.05
[config] epochs: 5
[config] 
[config] # Toggles
[config] tie_embeddings: true
[config] grad_checkpointing: true
[config] use_sdpa: true
[config] optimizer: adafactor
[config] sep_mask_enabled: true
[config] 
[config] # Data
[config] windows_per_seq: 2
[config] val_frac: 0.1
[config] test_frac: 0.1
[config] datasets:
[config]   - name: ecoli_k12
[config]     gbff: data/raw/Enterobacteriaceae/GCF_000005845.gbff
[config]     min_len: 90
[config] 
[config] out_dir: outputs/checkpoints
[config] scores_dir: outputs/scores
[config] log_csv: curves.csv
[config] seed: 1337
[config] 
[info] extra_datasets_cli=none
[cfg] sha256=652c2d945f474f69fe6fb6ba83a85e628bbfdd06d57f4f46bf264e7cc559866b file=configs/m2_depth_upgrade.yaml
[git] commit=51d4a41 dirty=False
[build] train: (3436, 320) (windows=3436) → data/processed/ecoli_k12/train_bs320.npz
[pack-stats] train: avg_cds_per_window=1.99 sep_pct=0.003 pad_pct=0.003
[build] val: (380, 320) (windows=380) → data/processed/ecoli_k12/val_bs320.npz
[pack-stats] val: avg_cds_per_window=1.99 sep_pct=0.003 pad_pct=0.005
[build] test: (437, 320) (windows=437) → data/processed/ecoli_k12/test_bs320.npz
[pack-stats] test: avg_cds_per_window=1.96 sep_pct=0.003 pad_pct=0.004
[prepare] skip extract ecoli_k12
[prepare] skip tokenize ecoli_k12
[prepare] run python -m src.codonlm.build_dataset --ids data/processed/ecoli_k12/codon_ids.txt --group_meta data/processed/ecoli_k12/cds_meta.tsv --block_size 320 --windows_per_seq 2 --val_frac 0.1 --test_frac 0.1 --out_dir data/processed/ecoli_k12 --pack_mode multi
[prepare] wrote runs/2025-11-08_m2_16L6H_d256_e5/pipeline_prepare.json
[integrity] ok: empty_windows train=0 val=0 test=0
[info] combined_manifest=data/processed/combined/2025-11-08_m2_16L6H_d256_e5/manifest.json
[info] train_npz=data/processed/combined/2025-11-08_m2_16L6H_d256_e5/train_bs320.npz
[info] val_npz=data/processed/combined/2025-11-08_m2_16L6H_d256_e5/val_bs320.npz
[info] test_npz=data/processed/combined/2025-11-08_m2_16L6H_d256_e5/test_bs320.npz
[info] primary_dna=data/processed/ecoli_k12/cds_dna.txt
[cfg] combined_manifest.sha256=6f34068331394901bd52d6cd2ea0c7158cce754d92dafdd042e2182265077301
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/User/github/genomics-lm/src/codonlm/train_codon_lm.py", line 513, in <module>
    main()
  File "/Users/User/github/genomics-lm/src/codonlm/train_codon_lm.py", line 193, in main
    model = TinyGPT(
            ^^^^^^^^
  File "/Users/User/github/genomics-lm/src/codonlm/model_tiny_gpt.py", line 97, in __init__
    self.blocks = nn.ModuleList([Block(n_embd, n_head, dropout, block_size) for _ in range(n_layer)])
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/User/github/genomics-lm/src/codonlm/model_tiny_gpt.py", line 97, in <listcomp>
    self.blocks = nn.ModuleList([Block(n_embd, n_head, dropout, block_size) for _ in range(n_layer)])
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/User/github/genomics-lm/src/codonlm/model_tiny_gpt.py", line 70, in __init__
    self.attn = CausalSelfAttention(n_embd, n_head, dropout, block_size)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/User/github/genomics-lm/src/codonlm/model_tiny_gpt.py", line 9, in __init__
    assert n_embd % n_head == 0
           ^^^^^^^^^^^^^^^^^^^^
AssertionError
